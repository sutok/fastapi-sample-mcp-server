# 受付順番管理システム 要件定義書

## 1. システム概要

### 1.1 目的
- 店舗の受付順番管理業務の効率化
- 顧客の待ち時間の可視化
- 受付状況のリアルタイム把握

### 1.2 想定ユーザー
- 店舗管理者
- 受付を待つ顧客

### 1.3 システム化の範囲
- 受付順番の管理
- 待ち時間の管理
- 受付状況の可視化
- 通知管理

## 2. 機能要件

### 2.1 必須機能（優先度：高）
1. 受付管理機能
   - 受付番号の発行
   - 現在対応中の番号表示
   - 次の呼び出し番号の管理
   - 受付状態の管理（待機中/対応中/完了/キャンセル）
   
2. 顧客管理機能
   - 受付番号の発行履歴
   - 待ち人数の管理
   - 概算待ち時間の計算
   
3. 通知機能
   - 順番接近通知（あと3人前など）
   - 呼び出し通知
   - キャンセル通知

### 2.2 追加機能（優先度：中）
1. 待ち時間表示機能
2. 統計レポート（平均待ち時間、時間帯別混雑状況など）
3. 顧客フィードバック機能

## 3. 非機能要件

### 3.1 性能要件
- 画面表示速度：5秒以内
- 同時接続ユーザー：100人以上
- データバックアップ：日次

### 3.2 セキュリティ要件
- ユーザー認証
  - メールアドレスとパスワードによる認証
  - 多要素認証（2FA）の実装
  
- アクセス制御
  - 企業レベルのアクセス制御
    - 企業間のデータ分離
    - 企業IDに基づくデータアクセス制限
  - 店舗レベルのアクセス制御
    - 店舗スタッフは自店舗のデータのみアクセス可能
    - 店舗管理者は担当店舗のデータのみアクセス可能
  - ロールベースのアクセス制御（RBAC）
    - システム管理者
      - すべての機能にアクセス可能
      - システム設定の変更が可能
      - 全企業・店舗のデータ参照可能
    - 企業管理者
      - 自社の全店舗の管理が可能
      - 店舗の追加・削除が可能
      - 店舗管理者の任命が可能
    - 店舗管理者
      - 担当店舗の設定変更が可能
      - スタッフの管理が可能
      - 統計データの参照が可能
    - 店舗スタッフ
      - 受付番号の発行が可能
      - 順番の管理が可能
      - 顧客対応状況の更新が可能
    - 利用者（一般ユーザー）
      - 自身の受付番号の確認のみ可能
      - 待ち時間の確認が可能
      - 順番状況の閲覧が可能
      - 自身の順番のキャンセルが可能

- データアクセス制御の実装要件
  - すべてのAPIリクエストに企業IDと店舗IDの検証を実装
  - ミドルウェアでのアクセス権限チェック
  - データベースクエリ時の企業IDと店舗IDによるフィルタリング
  
- データ暗号化
  - 通信経路の暗号化（HTTPS）
  - 個人情報の暗号化保存
  - アクセストークンの暗号化

- セキュリティ監査
  - アクセスログの記録
  - 重要操作の監査ログ保存
  - 不正アクセスの検知と通知

### 3.3 運用保守要件
- 営業時間内の安定稼働
- 計画メンテナンス：月1回
- 障害復旧時間：30分以内

## 4. 制約条件

### 4.1 開発環境
[現在の設計書の内容を維持]

### 4.2 開発期間
- 開発期間：3ヶ月
- テスト期間：1ヶ月

### 4.3 法的要件
- 個人情報保護法への準拠