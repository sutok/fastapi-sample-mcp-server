# 画面遷移設計書

## 1. 概要

本システムの画面遷移フローを定義します。ユーザーの操作性と UX を最適化するため、以下の設計方針に基づいて実装を行います。

## 2. 画面一覧

### 2.1 共通コンポーネント

- ヘッダー（`Header.tsx`）
  - ロゴ
  - メインナビゲーション
  - ユーザーメニュー
- フッター（`Footer.tsx`）
  - コピーライト
  - サイトマップ
  - お問い合わせリンク

### 2.2 認証関連画面

- ログイン画面（`/auth/login`）
- 新規登録画面（`/auth/signup`）
- パスワードリセット画面（`/auth/reset-password`）
- メール確認画面（`/auth/verify-email`）

### 2.3 予約関連画面

- 予約一覧画面（`/reservations`）
- 予約詳細画面（`/reservations/:id`）
- 予約作成画面（`/reservations/new`）
- 予約編集画面（`/reservations/:id/edit`）
- 予約確認画面（`/reservations/confirm`）
- 予約完了画面（`/reservations/complete`）

### 2.4 ユーザー関連画面

- プロフィール画面（`/profile`）
- プロフィール編集画面（`/profile/edit`）
- 設定画面（`/settings`）

### 2.5 管理者画面

- ダッシュボード（`/admin`）
- ユーザー管理（`/admin/users`）
- 予約管理（`/admin/reservations`）
- システム設定（`/admin/settings`）

## 3. 画面遷移フロー

### 3.1 認証フロー

```mermaid
graph TD
    A[ログイン画面] --> B{認証成功?}
    B -->|Yes| C[ホーム画面]
    B -->|No| A
    A --> D[新規登録画面]
    D --> E{登録成功?}
    E -->|Yes| F[メール確認画面]
    E -->|No| D
    A --> G[パスワードリセット画面]
```

### 3.2 予約フロー

```mermaid
graph TD
    A[予約一覧] --> B[予約作成]
    B --> C[日時選択]
    C --> D[オプション選択]
    D --> E[予約確認]
    E --> F{予約成功?}
    F -->|Yes| G[予約完了]
    F -->|No| E
    A --> H[予約詳細]
    H --> I[予約編集]
    H --> J[予約キャンセル]
```

## 4. 画面レイアウト

### 4.1 共通レイアウト

```tsx
// layouts/MainLayout.tsx
const MainLayout: React.FC = ({ children }) => {
  return (
    <div className="min-h-screen">
      <Header />
      <main className="container mx-auto px-4 py-8">{children}</main>
      <Footer />
    </div>
  );
};
```

### 4.2 認証レイアウト

```tsx
// layouts/AuthLayout.tsx
const AuthLayout: React.FC = ({ children }) => {
  return (
    <div className="min-h-screen bg-gray-50">
      <div className="max-w-md mx-auto p-6">
        <div className="bg-white rounded-lg shadow-lg p-8">{children}</div>
      </div>
    </div>
  );
};
```

## 5. コンポーネント設計

### 5.1 共通コンポーネント

```tsx
// components/Button.tsx
interface ButtonProps {
  variant: "primary" | "secondary" | "danger";
  size: "sm" | "md" | "lg";
  children: React.ReactNode;
  onClick?: () => void;
  disabled?: boolean;
}

const Button: React.FC<ButtonProps> = ({
  variant,
  size,
  children,
  onClick,
  disabled,
}) => {
  // ...
};
```

### 5.2 フォームコンポーネント

```tsx
// components/forms/Input.tsx
interface InputProps {
  type: "text" | "email" | "password" | "number";
  label: string;
  value: string;
  onChange: (value: string) => void;
  error?: string;
  required?: boolean;
}

const Input: React.FC<InputProps> = ({
  type,
  label,
  value,
  onChange,
  error,
  required,
}) => {
  // ...
};
```

## 6. 状態管理

### 6.1 グローバル状態

```tsx
// store/auth.ts
interface AuthState {
  user: User | null;
  isAuthenticated: boolean;
  loading: boolean;
}

const authSlice = createSlice({
  name: "auth",
  initialState,
  reducers: {
    // ...
  },
});
```

### 6.2 ローカル状態

```tsx
// hooks/useReservationForm.ts
const useReservationForm = (initialData?: Reservation) => {
  const [formData, setFormData] = useState({
    date: "",
    time: "",
    // ...
  });

  const validate = () => {
    // ...
  };

  const handleSubmit = async () => {
    // ...
  };

  return {
    formData,
    setFormData,
    validate,
    handleSubmit,
  };
};
```
